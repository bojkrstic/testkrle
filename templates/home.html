<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Home Page</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table.taxrates { border-collapse: collapse; width: 100%; max-width: 100%; }
        table.taxrates th, table.taxrates td { border: 1px solid #e7f0e8; padding: 8px; text-align: left; }
        table.taxrates th { background-color: #f1f0f5; }
        table.taxrates tr:nth-child(even) { background-color: #f1ecec; }
        .container { max-width: 1000px; margin: 0 auto; }
        @media (max-width: 600px) {
            table.taxrates thead { display: none; }
            table.taxrates tr { display: block; margin-bottom: 12px; }
            table.taxrates td { display: block; text-align: right; padding-left: 50%; position: relative; }
            table.taxrates td::before { content: attr(data-label); position: absolute; left: 0; width: 45%; padding-left: 8px; font-weight: bold; text-align: left; }
        }
    </style>
</head>
<body>
    
    <header>
        {{template "headerFragment" .}}
    </header>

    <section class="container">
        <h2>Tax Rates table</h2>
        <!-- <p>Version: {{.Version}}</p> -->

        <h3>MNP Gate Config</h3>
        {{if .TaxRates}}
        <form method="get" style="margin-bottom:12px;">
            <label>ID: <input type="text" name="id" value="{{.Filters.ID}}" size="6"></label>
            <label>Engine: <input type="text" name="engine" value="{{.Filters.Engine}}" size="12"></label>
            <button type="submit">Filter</button>
            <a href="/">Reset</a>
        </form>
        <table class="taxrates" role="table" aria-label="MNP Gate Config">
            <thead>
                <tr>
                    <th><a href="{{.BaseQueryPrefix}}sort=id&dir={{if eq .Sort "id"}}{{if eq .Dir "asc"}}desc{{else}}asc{{end}}{{else}}asc{{end}}">ID{{if eq .Sort "id"}} ({{.Dir}}){{end}}</a></th>
                    <th><a href="{{.BaseQueryPrefix}}sort=engine&dir={{if eq .Sort "engine"}}{{if eq .Dir "asc"}}desc{{else}}asc{{end}}{{else}}asc{{end}}">Engine{{if eq .Sort "engine"}} ({{.Dir}}){{end}}</a></th>
                    <th><a href="{{.BaseQueryPrefix}}sort=max_workers&dir={{if eq .Sort "max_workers"}}{{if eq .Dir "asc"}}desc{{else}}asc{{end}}{{else}}asc{{end}}">Max Workers{{if eq .Sort "max_workers"}} ({{.Dir}}){{end}}</a></th>
                    <th><a href="{{.BaseQueryPrefix}}sort=cache_days&dir={{if eq .Sort "cache_days"}}{{if eq .Dir "asc"}}desc{{else}}asc{{end}}{{else}}asc{{end}}">Cache Days{{if eq .Sort "cache_days"}} ({{.Dir}}){{end}}</a></th>
                    <th>Config</th>
                </tr>
            </thead>
            <tbody>
                {{range .TaxRates}}
                <tr>
                    <td data-label="ID">{{.ID}}</td>
                    <td data-label="Engine">{{.Engine}}</td>
                    <td data-label="Max Workers">{{.MaxWorkers}}</td>
                    <td data-label="Cache Days">{{.CacheDays}}</td>
                    <td data-label="Config">{{.Config}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>
        <nav aria-label="Pagination" style="margin-top:12px;">
            <div>
                {{if gt .PrevPage 0}}
                <a href="?page={{.PrevPage}}">&laquo; Prev</a>
                {{end}}

                <span style="margin:0 8px;">Page {{.Page}} of {{.TotalPages}}</span>

                {{if gt .NextPage 0}}
                <a href="?page={{.NextPage}}">Next &raquo;</a>
                {{end}}
            </div>

            <div style="margin-top:8px;">
                {{/* show a range of page links: current-2 .. current+2 */}}
                {{ $start := sub .Page 2 }}
                {{ $end := add .Page 2 }}
                {{ if lt $start 1 }}{{ $start = 1 }}{{ end }}
                {{ if gt $end .TotalPages }}{{ $end = .TotalPages }}{{ end }}
                {{ range $i := seq $start $end }}
                    {{ if eq $i $.Page }}
                        <strong>{{$i}}</strong>
                    {{ else }}
                        <a href="?page={{$i}}">{{$i}}</a>
                    {{ end }}
                    {{ if lt $i $end }} &nbsp; {{ end }}
                {{ end }}
            </div>
        </nav>
        {{else}}
        <p>No tax rates found.</p>
        {{end}}
    </section>

    <footer>
        {{template "footerFragment" .}}
    </footer>

</body>
</html>